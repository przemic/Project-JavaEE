<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./mainTemplate.xhtml"
                xmlns:p="http://primefaces.org/ui">

    
    <ui:define name="content">
       <div id="pageTitle">
           <h1>Najnowsze wydarzenia</h1>
       </div> 
       <p:messages id="messages" showDetail="true" autoUpdate="true"/>    
       
        
        <h:form>  
  
    <p:dataGrid var="item" value="#{eventController.getAll()}" columns="3"  
        rows="12" paginator="true"  
        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
        rowsPerPageTemplate="9,12,15"   >  
          
        <p:column style="background-color: #A67245;">  
            <p:panel header="#{item.name}" style="text-align:center; background-color: #FFE1C4;">  
                <h:panelGrid columns="1" style="width:100%">  
                                      
                    <h:outputText value="#{item.descriptionText}" />  
                    
                    <p:commandLink rendered="#{facesContext.externalContext.userPrincipal.name != NULL}" 
                                   actionListener="#{userController.assignUserToEvent(facesContext.externalContext.userPrincipal.name, item)}"  
                                   update=":messages" title="Dodaj do ulubionych">  
                        <p:graphicImage value="/event.png"/>   
                          
                    </p:commandLink>
                    <p:commandLink actionListener="#{eventController.setChoosen(item)}" 
                                   oncomplete="detailE.show()"
                                   update=":editDD:displayEdit"
                                    title="Pokaz">  
                        <p:graphicImage value="/place.png"/>  
                        
                          
                    </p:commandLink>
                  
                   
                    
                   
                    
                </h:panelGrid>  
            </p:panel>  
        </p:column>  
        
  
    </p:dataGrid>  
    </h:form>  
    <p:dialog header="Informacje o wydarzeniu" modal="true" showEffect="fade" hideEffect="fade" widgetVar="detailE">  
        <h:form id="editDD">
            <h:panelGrid columns="2" id="displayEdit" style="text-align: left;">  
                <h:outputLabel value="Nazwa wydarzenia:" for="name" style="font-weight: bold;"/>                    
                <h:outputText id="name" value="#{eventController.choosen.name}" title="Nazwa wydarzenia" style="font-weight: bold;"/>

                <h:outputLabel value="Data wydarzenia" for="date" style="font-weight: bold;"/> 
                <p:calendar value="#{eventController.choosen.date}" mode="inline" readonly="true" id="inlineCal"/> 

                <h:outputLabel value="Opis wydarzenia" for="descriptionText" style="font-weight: bold;"/>
                <h:inputTextarea rows="5" cols="30" readonly="true"   id="descriptionText" value="#{eventController.choosen.descriptionText}" title="#{bundle.CreateEventTitle_descriptionText}" />

                <h:outputLabel value="Miejse w którym odbywać ma się wydarzenie:" for="placeid" style="font-weight: bold;" />
                <h:outputText id="pp" value="#{eventController.choosen.placeid.name}" title="Nazwa miejsca" />


            </h:panelGrid>                                
            <p:gmap id="gmap" center="#{eventController.choosen.placeid.latitude},#{eventController.choosen.placeid.longitude}" zoom="13" type="HYBRID"   
                style="width:600px;height:400px"                                      
                model="#{placeController.getEmptyModel(eventController.choosen.placeid.latitude ,eventController.choosen.placeid.longitude)}"
                widgetVar="map" />
            <br />
            <center>            
                <p:commandButton id="cancelEditButton" value="Zamknij"  oncomplete="detailE.hide()" />
            </center>
        </h:form>
    </p:dialog>   
    
            
   
  


    </ui:define>

               

</ui:composition>
</html>
